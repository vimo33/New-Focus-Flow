{
  "id": "msg-20260215-227669",
  "thread_id": "thread-20260215-227666",
  "role": "user",
  "content": "This Product Requirement Document (PRD) is optimized for **Claude Code Opus 4.6 Agent Teams**. It follows the 2026 \"Sequential Phase\" methodology, designed to minimize context drift and maximize parallel efficiency across sub-agents coordinated by a central orchestrator.\n\n---\n\n# PRD: AURA — The Zurich Discovery Engine (POC)\n\n**Target Engineering Team:** Claude Code Opus 4.6 (Orchestrator) + Haiku 4.5 (Execution Sub-agents)\n**Project Version:** 1.0.0 (Zurich Pilot)\n**Context Window Strategy:** 1M Token Context (Beta) enabled for full repository/knowledge base ingestion.\n\n---\n\n## 1. Executive Summary & Vision\n\nAura is a privacy-first, AI-driven urban exploration platform. Unlike traditional \"passive\" audio guides, Aura uses **on-device multimodal AI (Gemma 3n)** to enable a \"point-discover-converse\" loop. Users can point their phone at Zurich landmarks to initiate interactive, historically accurate roleplays with AI-powered historical figures.\n\n### Core Strategic Pillars\n\n1. **Experiential Innovation:** Transition from spectator to participant via choice-driven narratives.\n2. **Privacy-First Architecture:** On-device AI processing ensures no location or visual data leaves the device.\n\n\n3. **Full Offline Functionality:** Pre-downloadable \"City Packs\" eliminate data roaming costs for international tourists.\n\n\n\n---\n\n## 2. Technical Stack (POC Specification)\n\n| Component | Technology | Rationale |\n| --- | --- | --- |\n| **Orchestrator** | Claude Opus 4.6 | Superior reasoning and 1M context for complex agent coordination. |\n| **On-Device LLM** | Gemma 3n (1B/4B) | 529MB size; optimized for low-latency mobile GPU/NPU inference (2500+ tok/sec). |\n| **Inference Engine** | Google AI Edge (LiteRT) | Cross-platform support for INT4/INT8 quantized models. |\n| **Local Database** | SQLite | High-performance, relational offline storage for \"City Packs\".\n\n |\n| **Vision Model** | MobileNet-V5 (Gemma 3n Encoder) | Optimized for 300M parameters; 13x faster than baseline SoViT. |\n| **Framework** | React Native / Flutter | Rapid cross-platform UI prototyping. |\n\n---\n\n## 3. Sequential Implementation Roadmap\n\n*Note to Agents: Do not proceed to the next phase until TDD (Test-Driven Development) coverage for the current phase is >95%.*\n\n### Phase 1: Local Foundation & \"City Pack\" Schema\n\n**Objective:** Establish the offline SQLite structure and file system for bundled assets.\n\n* **Tasks:**\n* Implement `CityPackService` to handle `.zip` extraction of maps, models, and narrative JSONs.\n* Define SQLite schema for `Landmarks`, `HistoricalFigures`, `NarrativeNodes`, and `MediaAssets`.\n* **DO NOT CHANGE:** The base schema must remain immutable after Phase 1 completion.\n\n\n\n### Phase 2: On-Device Vision & Recognition\n\n**Objective:** Implement the \"Point\" aspect of the loop using on-device computer vision.\n\n* **Tasks:**\n* Integrate Gemma 3n Vision Encoder for landmark identification.\n* Implement a 1024-token sliding window for local attention to minimize memory footprint.\n* Target: <500ms latency from camera capture to landmark ID.\n\n\n\n\n\n### Phase 3: Conversational Engine (Gemma 3n)\n\n**Objective:** Deploy the quantized Gemma 3n 1B model for on-device NLU.\n\n* **Tasks:**\n* Implement `ConversationManager` to handle \"Walled Garden\" RAG (Retrieval-Augmented Generation).\n* Restrict LLM output to vetted historical nodes to prevent hallucinations.\n* Support for pre-generated TTS audio file playback to preserve battery.\n\n\n\n### Phase 4: Interactive Historical Roleplay (Zwingli & Gaius)\n\n**Objective:** Build the branching narrative logic for the Zurich pilot.\n\n* **Tasks:**\n* Implement choice-driven dialogue state machine.\n* Integrate the \"Gaius Valerius\" (Roman) and \"Huldrych Zwingli\" (Reformation) content modules.\n\n\n\n\n\n---\n\n## 4. Non-Functional Requirements & Guardrails\n\n* **Hallucination Limit:** 0% tolerance for non-vetted historical facts. Use the \"HITL\" (Human-in-the-Loop) protocol: the LLM may only rephrase or navigate *existing* verified text.\n\n\n* **Latency Target:**\n* Visual Recognition: <1 second.\n* Dialogue Response (On-device): <300ms.\n\n\n* **Privacy Guardrail:** `PrivacyEnforcer` module must intercept any outgoing network calls during the \"Core Loop\" to ensure data residency.\n* **Battery Impact:** Limit CPU/GPU utilization to 15-minute bursts to prevent thermal throttling on mid-range devices.\n\n---\n\n## 5. Agent Team Orchestration Instructions\n\nTo execute this build, initialize the environment as follows:\n\n1. **Orchestrator Setup:** Use `.claude/settings.json` to enable `teammateMode: tmux`.\n2. **Adaptive Thinking:** Configure the lead agent with `thinking: {type: \"adaptive\", effort: \"high\"}` for architectural decisions.\n3. **Sub-Agent Assignment:**\n* **Agent 1 (Logic):** Database, State Management, SQLite.\n* **Agent 2 (AI/ML):** Gemma 3n integration, LiteRT, Quantization hooks.\n* **Agent 3 (UX/UI):** Camera views, Map interfaces, Conversation bubbles.\n\n\n\n---\n\n## 6. Acceptance Criteria (POC Discovery Loop)\n\n1. **Trigger:** User aims camera at Grossmünster.\n2. **Detection:** App identifies the church within 800ms offline.\n3. **Interaction:** 3D Huldrych Zwingli appears; user selects \"Why did you eat sausages?\"\n4. **Response:** App plays Zwingli's audio response (offline) and presents the next narrative choice.\n5. **Privacy Check:** Wireshark logs show zero packets sent to external IPs during the session.\n\n**Approved by:** Strategic Analysis Board\n**Date:** February 12, 2026",
  "source": "text",
  "created_at": "2026-02-15T00:10:27.669Z"
}